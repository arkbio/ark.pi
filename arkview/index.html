<!doctype html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap-switch.css" />
    <link rel="stylesheet" type="text/css" href="css/jquery-ui.css">

  <script src="lib/jquery.min.js"></script>
  <script src="/lib/jquery-1.10.2.js"></script>
  <script src="/lib/jquery-ui.js"></script>
  <script src="/lib/jquery.ui.touch-punch.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script src="/lib/bootstrap-switch.js"></script>
  <script src="/lib/bootstrap.min.js"></script>

  <script src="http://www.amcharts.com/lib/amcharts.js"></script>

  <style>
    .sensor-panel {
      float:left;
      height:100%;
      margin-left: 200px;
    }
  </style>
</head>

<!--<body onload="sensorNow(); updateClock(); setInterval('updateClock()', 1000 );">  -->
<body class="ui-widget-content" style="border:0;">



  <div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner center">
      <!-- <div id="arkNav"> -->

        <!-- <img src="/img/sensa.io.png" style="height: 40px; width: auto; float: left; padding: 12px"> -->
        <img src="/img/sensa_circuit.png" style="height:50px; float: left; padding: 5px 0">
        <img src="/img/sensa_word.png" style="height:50px; float: left; padding: 5px 20px 0 0">
        <ul class="nav nav-pills" style="margin: 10px 10px 0 0">
          <li style="padding: 5px" class="active"><a href="#Recipe" data-toggle="pill">Experiment</a></li>
          <!--li style="padding: 5px"><a href="#Sensa" data-toggle="pill">Sensa</a></li-->
          <li style="padding: 5px"><a href="#Liquid" data-toggle="pill">Liquid</a></li>
          <li style="padding: 5px"><a href="#Light" data-toggle="pill">Light</a></li>
          <!-- <img src="/img/zephyr_logo.png" style="height: 40px; width: auto; float: left; padding: 12px"> -->

       </ul>
     <!-- </div> -->
    </div>
  </div>

  <div class="sensor-panel" id="sensorPanel">
    <!--div class="center" style="margin-top: 20px"-->
      <table><tbody>
        <tr>
          <td>
            <div id="sensor-switch" class="switch switch-small" data-on="success" data-off="">
              <input type="checkbox"/>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <h4>Temperature</h4>
          </td>
          <td>
            <h4 id="liquidTemp" class="sensa">&nbsp;</h4>
          </td>
        </tr>
        <tr>
          <td>
            <h4>pH</h4>
          </td>
          <td>
            <h4 id="pH" class="sensa">&nbsp;</h4>
          </td>
        </tr>
        <tr>
            <td>
              <h4>Redox</h4>
            </td>
            <td>
              <h4 id="Redox" class="sensa">&nbsp;</h4>
            </td>
          </tr>
          <tr>
            <td>
              <h4>Optical</h4>
            </td>
            <td>
              <h4 id="Optical" class="sensa">&nbsp;</h4>
            </td>
          </tr>
          <tr>
            <td>
              <h4>Flow</h4>
            </td>
            <td>
              <h4 id="Flow" class="sensa">&nbsp;</h4>
            </td>
          </tr>
        </tbody></table>
    <!--/div-->
  </div>


  <div class="tab-content">

    <div class="tab-pane" id="Liquid" style="float: left">

      <table>
        <tr>
          <td>
            <div class="well Activate center">
              <h4>Recirc</h4>
                  <div id="Recirc" class="switch switch-large" data-on="success" data-off="">
                      <input type="checkbox"/>
                  </div>
              <h4>Dose</h4>
                  <div id="Dose" class="switch switch-large" data-on="success" data-off="">
                    <input type="checkbox"/>
                  </div>
              <h4>Dispense</h4>
                  <div id="DispenseValve" class="switch switch-large" data-on="success" data-off="">
                    <input type="checkbox"/>
                    </div>
            </div>
            <!-- <div class="well DoseLiquid center">
                <h3> Feeder 1 </h3>
                <div class="fieldSize">
                     <div>
                       <h4>Amount</h4>
                       <select id="dose1-amount">
                                 <option value="5" >10mL</option>
                                 <option value="30" >50mL</option>
                                 <option value="60" >100mL</option>
                                 <option value="300" >500mL</option>
                       </select>
                     </div>
                     <div>
                       <h4># of Doses</h4>
                       <select id="dose1-interval">
                                 <option value="1" >1</option>
                                 <option value="5" >5</option>
                                 <option value="10" >10</option>
                                 <option value="15" >15</option>
                       </select>
                     </div>
                     <div>
                       <h4>Time Between Doses</h4>
                       <select id="dose1-interval">
                                 <option value="10" >10 minutes</option>
                                 <option value="30" >30 minutes</option>
                                 <option value="60" >1 hr</option>
                                 <option value="1440" >1 day</option>
                       </select>
                     </div>
                </div>
              </div> -->

            <!-- <div class="well Activate center">
              <h4>Direction</h4>
                    <div id="Direction" class="switch switch-large" data-on="primary" data-off="info" data-on-label="In" data-off-label="Out">
                    <input type="checkbox"/>
                   </div>
            </div> -->
          </td>
          <td>
            <div class ="well Activate center">
                  <h4>Load</h4>
                  <div id="LoadPump" class="switch switch-large" data-on="success" data-off="">
                    <input type="checkbox"/>
                  </div>
                  <h4>Recirc Valve</h4>
                  <div id="RecircValve" class="switch switch-large" data-on-label="Closed" data-off-label="Open" data-on="danger" data-off="success">
                        <input type="checkbox"/>
                  </div>
                  <h4>Drain Valve</h4>
                  <div id="DrainValve" class="switch switch-large" data-on-label="Open" data-off-label="Closed" data-on="success" data-off="danger">
                        <input type="checkbox"/>
                  </div>

            </div>
          </td>
          <td>
            <div class ="well Activate center">
                  <h4>Load</h4>
                  <div id="LoadPump" class="switch switch-large" data-on="success" data-off="">
                    <input type="checkbox"/>
                  </div>
                  <h4>Recirc</h4>
                  <div id="Recirc" class="switch switch-large" data-on="success" data-off="">
                      <input type="checkbox"/>
                  </div>
                  <h4>Mix</h4>
                  <div id="mixDirection" class="switch switch-small" data-on-label="Counter" data-off-label="Clock" data-on="default" data-off="">
                    <input type="checkbox"/>
                  </div>
                  <div id="slider-mix"></div>
            </div>
            <!-- <div class="well Incubate center">
            <h4>Thermocyle</h4>
              <div class="fieldSize">
                 <p>
                 <input type="text" id="amountThermocycle" style="border:0; color:#00CCFF; font-weight:bold; width=100px">
                 </p>

                 <div id="slider-thermocycle"></div>
              </div>
              <div id="Thermocycle" class="switch switch-small" data-on="success" data-off="">
                    <input type="checkbox"/>
              </div>
            </div> -->


            <!-- <div class="well Incubate center">
                <h4>Incubate</h4>
                <input type="text" id="amountIncubate" style="border:0; color:#00CCFF; font-weight:bold; width: 66px; margin-bottom: 0px">
                <div id="slider-incubate"></div>
                <div id="Incubate" class="switch" data-on="success" data-off="">
                      <input type="checkbox"/>
                </div>
            </div> -->


            <!--    <div class="fieldSize">
                  <div>
                    <select id="thermocycle-schedule">
                              <option value="5" >5 seconds</option>
                              <option value="30" >30 seconds</option>
                              <option value="60" >60 seconds</option>
                              <option value="300" >5 minutes</option>
                              <option value="600" >10 minutes</option>
                    </select>
                  </div>
               </div> -->
          </td>
        </tr>
      </tbody>
      </table>

    </div>

    <div class="tab-pane" id="Light" style="float:left">
      <div class="center" style="margin-top: 20px">
          <table><tbody>
              <tr>
                <td>
                <h4>Grow</h4>
                </td>
              </tr>
              <tr>
                <td>
                  <div id="growLight" class="switch switch-small" data-on="default" data-off="">
                    <input type="checkbox"/>
                  </div>
                </td>
                <td>
                  <!-- <input type="text" id="amountGrow" style="border:0; color:#993399; font-weight:bold; width: 220px; margin-bottom: 0px"> -->
                  <div id="slider-grow"></div>
                </td>
              </tr>
              <tr>
                <td>
                <h4>Indicate</h4>
                </td>
              </tr>
              <tr>
                <td>
                  <!-- <h4>R</h4> -->
                  <div id="RedLight" class="switch switch-small" data-on="danger" data-off="">
                   <input type="checkbox"/>
                  </div>
                </td>
                <td>
                  <div id="red"></div>
                </td>
              </tr>
              <tr>
                <td>
                  <!-- <h4>G</h4> -->
                   <div id="GreenLight" class="switch switch-small" data-on="success" data-off="">
                   <input type="checkbox"/>
                  </div>
                </td>
                <td>
                    <div id="green"></div>
                </td>
              </tr>
              <tr>
                <td>
                  <!-- <h4>B</h4> -->
                  <div id="BlueLight" class="switch switch-small" data-on="primary" data-off="">
                   <input type="checkbox"/>
                  </div>
                </td>
                <td>
                  <div id="blue"></div>
                </td>
                <!-- <div id="swatch" class="ui-widget-content ui-corner-all"></div> -->

              </tr>
           </tbody>
          </table>
      </div>

    </div>

    <div class="tab-pane active" id="Recipe" style="float: left">

      <div class ="well Activate center">
        <div class="dropdown" style="margin: 10px 0">
            <button class="btn btn-default dropdown-toggle" type="button" id="dropdownExperiments" data-toggle="dropdown" aria-expanded="true">
              Choose Experiment
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownExperiments">
              <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Arkeon</a></li>
              <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="Hypha">Hypha</a></li>
              <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Zome</a></li>
            </ul>
        </div>

        <div class="input-group">
          <!-- <span class="input-group-addon" id="basic-addon1">@</span> -->
          <input type="text" class="form-control" id="RecipeName" placeholder="Recipe Name" aria-describedby="basic-addon1">
        </div>
        <div class="input-group">
          <!-- <span class="input-group-addon" id="basic-addon1">@</span> -->
          <input type="text" class="form-control" placeholder="Ingredients" aria-describedby="basic-addon1">
        </div>
        <div class="input-group">
          <!-- <span class="input-group-addon" id="basic-addon1">@</span> -->
          <input type="text" class="form-control" placeholder="Time" aria-describedby="basic-addon1">
        </div>
        <div class="input-group">
          <!-- <span class="input-group-addon" id="basic-addon1">@</span> -->
          <input type="text" class="form-control" placeholder="Light" aria-describedby="basic-addon1">
        </div>
        <div class="input-group">
          <!-- <span class="input-group-addon" id="basic-addon1">@</span> -->
          <input type="text" class="form-control" placeholder="Heat" aria-describedby="basic-addon1">
        </div>
        <div class="input-group">
          <!-- <span class="input-group-addon" id="basic-addon1">@</span> -->
          <input type="text" class="form-control" placeholder="Feed" aria-describedby="basic-addon1">
        </div>
        <div class="input-group">
          <!-- <span class="input-group-addon" id="basic-addon1">@</span> -->
          <input type="text" class="form-control" placeholder="Air" aria-describedby="basic-addon1">
        </div>
        <button type="button" id="runExperiment" class="btn btn-primary">Ark</button>

      </div>
    </div>

    <div class="tab-pane" id="Graph">

      <!-- <div id="sensaChart" style="width: 100%; height: 340px;"></div> -->

      <!-- <div class="containedGraph">
        <center>
         <iframe id="igraph" src="http://plot.ly/~streaming-demos/52/" width="700" height="438" style="margin: 40px auto" seamless="seamless" scrolling="no"></iframe>
        </center>

        <center>
        <iframe id="igraph" src="https://plot.ly/~gmon01/32" width="700" height="438" style="margin: 40px auto" seamless="seamless" scrolling="no"></iframe>
        </center>
        </div> -->
    </div>

  </div>

<script>
// drop down Experiments menu
 
    jQuery("#Hypha").click(function(e){
      console.log("Hypha");
      //e.preventDefault();
      //$('#RecipeName').text("Hypha");
      document.getElementById("#Hypha").value = "aa";
    });


  // $('#dropdownExperiments').on('switch-change', function (e, data) {
</script>

<script>

    $('#myTab a[href="#Liquid"]').click(function (e) {
      e.preventDefault()
      $(this).tab('show')
    });

    $('#myTab a[href="#Light"]').click(function (e) {
      e.preventDefault()
      $(this).tab('show')
    });

    $('#myTab a[href="#Recipe"]').click(function (e) {
      e.preventDefault()
      $(this).tab('show')
    });

    $('#myTab a[href="#Sensa"]').click(function (e) {
      e.preventDefault()
      $(this).tab('show')
    });

    $('#myTab a[href="#Graph"]').click(function (e) {
      e.preventDefault()
      $(this).tab('show')
    });

</script>


<script>
// Run Experiment button
      $('#runExperiment').on('click', function (e, data) {
          socket.emit('command', {state: true , module:'Demo'});
          console.log(data);
      });

// On/Off sensa switches

      $('#sensor-switch').on('switch-change', function (e, data) {
          socket.emit('command', {state: data.value , module:'sensors'});
          console.log(data);
      });

// On/Off Actuation switches

      $('#Recirc').on('switch-change', function (e, data) {
          socket.emit('command', {state: data.value , module:'RecircPump'});
          console.log(data);
      });

      $('#Dose').on('switch-change', function (e, data) {
          socket.emit('command', {state: data.value , module:'DosePump'});
          console.log(data);
      });

      $('#LoadPump').on('switch-change', function (e, data) {
          socket.emit('command', {state: data.value , module:'LoadPump'});
          console.log(data);
      });

      $('#RecircValve').on('switch-change', function (e, data) {
          socket.emit('command', {state: data.value , module:'RecircValve'});
          console.log(data);
      });

      $('#DrainValve').on('switch-change', function (e, data) {
          socket.emit('command', {state: data.value , module:'DrainValve'});
          console.log(data);
      });

      $('#DispenseValve').on('switch-change', function (e, data) {
          socket.emit('command', {state: data.value , module:'DispenseValve'});
          console.log(data);
      });

      $('#growLight').on('switch-change', function (e, data) {
          socket.emit('command', {state: data.value , module:'growLight'});
          console.log(data);
      });

      $('#Air').on('switch-change', function (e, data) {
          socket.emit('command', {state: data.value , module:'AirPump'});
          console.log(data);
      });

      $('#mixDirection').on('switch-change', function (e, data) {
          socket.emit('command', {state: data.value , module:'mixDirection'});
          console.log(data);
      });


</script>


<script>
//send sensa up to UI

    // var host = window.document.location.host.replace(/:.*/, '');
    //   console.log(host);
    //var socket = io.connect('/');

    // var socket = io.connect('http://192.168.1.225:8088'); //James' Router
    var socket = io.connect('http://25.124.233.64:8088'); //Hamachi
    // var socket = io.connect('http://192.168.255.100:8088'); //Frank's Router

    socket.on('connect', function() { console.log('websocket connected'); });
    socket.on('error', function(err)  { console.log('websocket error: ' + err); });
    socket.on('connect_failed', function(err)  { console.log('websocket error: ' + err); });

    socket.on('sensor_reading', function(data){
      console.log('sensor_reading:' + data);
      if (data === 'NaN' || isNaN(data)) data = 50 + 30*Math.random();

      chart.dataProvider.push({
        date: new Date(),
        readings: data
      });
      chart.validateData();

      if (gAtEnd) {
        var end = chart.chartData.length - 1;
        chart.zoomToIndexes(end - gLength, end);
      }
    });

    socket.on('sensor_report', function(data){
      console.log('Sensor Report: ' + JSON.stringify(data));
      if (data === undefined || data.measurement === undefined || data.measurement.datum === undefined) {
        console.log('null sensor report');
        return;
      }

      var datum = data.measurement.datum;

      if ( data.measurement.label === "temp" ) {
        var tempF = ((1.8)*datum + 32).toFixed(2);
        $('#liquidTemp').text(tempF + ' ˚F');
      }
      else if ( data.measurement.label === "pH" ) {
        $('#pH').text(datum);
      }
      else if ( data.measurement.label === "ORP" ) {
        $('#Redox').text(datum);
      }
      else if ( data.measurement.label === "optical" ) {
        $('#Optical').text(datum);
      }
      else if ( data.measurement.label === "flow" ) {
        $('#Flow').text(datum);
      }

      if (datum !== data.measurement.datum) console.log('msg changed somehow');
    });

  </script>

  <script>
  //Modulation for Mixer
    $(function() {
    $( "#slider-mix" ).slider({
      // range: true,
      min: 0,
      max: 50,
      values: [0],
      slide: function( event, ui ) {
        $( "#amountMix" ).val(ui.values[ 0 ] + "%");

        var mixVal = $( "#slider-mix" ).slider( "values", 0 );
        console.log('Mix Speed:', mixVal );
        socket.emit('command', {state: true , module:'mixSpeed', value: mixVal});
      }
    });
    // $( "#amountGrow" ).val( $( "#slider-grow" ).slider( "values", 0 ) + "%");
    $( "#slider-mix" ).slider( "value", 0 );
    $( "#slider-mix" ).slider("enable");

  });
  </script>

  <script>
  //Switches for lights
  //When On, enable slider; when Off, disable slider and set back to 0

     $('#growLight').on('switch-change', function (e, data) {
         if ( data.value ) {
            $("#slider-grow").slider("enable");
         } else {
            $("#slider-grow").slider("disable");
            $("#slider-grow" ).slider( "value", 0 );
         }
         console.log(data.value);
     });

      $('#RedLight').on('switch-change', function (e, data) {
          if ( data.value ) {
             $( "#red" ).slider("enable");
          } else {
             $( "#red" ).slider("disable");
             $( "#red" ).slider( "value", 0 );
          }
          console.log(data.value);
          // socket.emit('command', {state: data.value , module:'lights', relayID:'Mosfet1', value: $( "#red" ).slider( "value" ) });
      });

      $('#GreenLight').on('switch-change', function (e, data) {
          if ( data.value ) {
             $( "#green" ).slider("enable");
          } else {
             $( "#green" ).slider("disable");
             $( "#green" ).slider( "value", 0 );
          }
      });

      $('#BlueLight').on('switch-change', function (e, data) {
          if ( data.value ) {
             $( "#blue" ).slider("enable");
          } else {
             $( "#blue" ).slider("disable");
             $( "#blue" ).slider( "value", 0 );
          }
      });

  </script>

  <script>
  //Modulation for Grow lights
    $(function() {
    $( "#slider-grow" ).slider({
      // range: true,
      min: 0,
      max: 255,
      values: [0],
      slide: function( event, ui ) {
        $( "#amountGrow" ).val(ui.values[ 0 ] + "%");

        var growVal = $( "#slider-grow" ).slider( "values", 0 );
        console.log('Grow Intensity:', growVal );
        socket.emit('command', {state: true , module:'growLight', value: growVal});
      }
    });
    // $( "#amountGrow" ).val( $( "#slider-grow" ).slider( "values", 0 ) + "%");
    $( "#slider-grow" ).slider( "value", 0 );
    $( "#slider-grow" ).slider("disable");

  });
  </script>

  <script>
  //Modulation for RGB Light sliders

    function hexFromRGB(r, g, b) {
      var hex = [
        r.toString( 16 ),
        g.toString( 16 ),
        b.toString( 16 )
      ];
      $.each( hex, function( nr, val ) {
        if ( val.length === 1 ) {
          hex[ nr ] = "0" + val;
        }
      });
      return hex.join( "" ).toUpperCase();
    }
    function refreshSwatch() {
      var red = $( "#red" ).slider( "value" ),
        green = $( "#green" ).slider( "value" ),
        blue = $( "#blue" ).slider( "value" ),
        hex = hexFromRGB( red, green, blue );
      $( "#swatch" ).css( "background-color", "#" + hex );
      output_values("RGB", [ $('#RedLight'), $('#GreenLight'), $('#BlueLight') ], [red,green,blue]);
    }

    $(function() {
      $( "#red, #green, #blue" ).slider({
        orientation: "horizontal",
        range: "min",
        max: 255,
        value: 127,
        slide: refreshSwatch,
        change: refreshSwatch
      });
      $( "#red" ).slider( "value", 255 );
      $( "#green" ).slider( "value", 255 );
      $( "#blue" ).slider( "value", 255 );
      $("#red").slider("disable");
      $("#green").slider("disable");
      $("#blue").slider("disable");
   });

   function output_values(user_control_id, onoff_controls, values_array)
   {
         var red = $( "#red" ).slider( "value" ),
         green = $( "#green" ).slider( "value" ),
         blue = $( "#blue" ).slider( "value" );
         console.log('current colors:', red, green, blue);
         socket.emit('command', {state: true , module:'lights', relayID:'Indicators', values: {red:red, green:green, blue:blue} });
   }
  </script>

  <script>
  //Switches for Temperature
      $('#Incubate').on('switch-change', function (e, data) {
          if ( !data.value ) {
             $("#slider-incubate").slider("enable");
          } else {
             $("#slider-incubate").slider("disable");
          }
          if ( data.value ) {
             socket.emit('command', { module: 'incubate', value: $( "#slider-incubate" ).slider( "values", 0 ) } );
          } else {
            socket.emit('command', { module:'incubate-off'});
          }

      });

      $('#Thermocycle').on('switch-change', function (e, data) {
          if ( !data.value ) {
             $("#slider-thermocycle").slider("enable");
          } else {
             $("#slider-thermocycle").slider("disable");
          }

          if ( data.value ) {
            console.log('thermocycle');

            // var x=document.getElementById("thermocycle-schedule").selectedIndex;
            // var y=document.getElementById("thermocycle-schedule").options;
            // alert("Schedule updated: " + y[x].text );
            // var timerValue = y[x].value;


            var lbT = $( "#slider-thermocycle" ).slider( "values", 0 );
            var ubT = $( "#slider-thermocycle" ).slider( "values", 1 );

            socket.emit('command', { module:'thermocycle', values: {lower_bound_temp:lbT, upper_bound_temp:ubT } });

          } else {
            socket.emit('command', { module:'thermocycle-off'});
          }
      });
  </script>

  <script>
  //Modulation for Incubate slider
    $(function() {
    $( "#slider-incubate" ).slider({
      // range: true,
      min: 40,
      max: 100,
      values: [70],
      slide: function( event, ui ) {
        $( "#amountIncubate" ).val(ui.values[ 0 ] + "ºF");
      }
    });
    $( "#amountIncubate" ).val( $( "#slider-incubate" ).slider( "values", 0 ) + "ºF");
    $( "#slider-incubate" ).slider("enable");
  });
  </script>

  <script>
  //Modulation for Thermocycle Liquid slider
    $(function() {
      $( "#slider-thermocycle" ).slider({
        range: true,
        min: 70,
        max: 90,
        values: [ 75, 85 ],
        slide: function( event, ui ) {
          $( "#amountThermocycle" ).val( ui.values[ 0 ] + "ºF - " + ui.values[ 1 ] + "ºF" );
        }
      });
      $( "#amountThermocycle" ).val($( "#slider-thermocycle" ).slider( "values", 0 ) +
        "ºF - " + $( "#slider-thermocycle" ).slider( "values", 1 ) +"ºF" );
      $( "#slider-thermocycle" ).slider("enable");
    });
  </script>

  <script>
  //       $('#arkSchedule').on('switch-change', function (e, data) {
  //         var panel ={
  //               waterHeater:{meter: 'liquidTemp', use: false},
  //               spaceHeater:{meter: 'airTemp', use: false},
  //               airPump:{meter: 'ph', use: false},
  //               waterPump:{meter: 'timer', use: false}
  //           };


  //         // var checkOnOff = document.getElementById("checkWaterHeater").checked;
  //         // if (checkOnOff) {
  //           var upperLiquidTemp = document.getElementById("waterHeaterHigh").value;
  //           var lowerLiquidTemp = document.getElementById("waterHeaterLow").value;

  //             panel.waterHeater.use = {
  //               LE:  {state: "on", value: lowerLiquidTemp},
  //               GE:  {state: "off", value: upperLiquidTemp}
  //             };


  //         // }


  //         // checkOnOff = document.getElementById("checkSpaceHeater").checked;
  //         // if (checkOnOff) {
  //         //   var upperAirTemp = document.getElementById("spaceHeaterHigh").value;
  //         //   var lowerAirTemp = document.getElementById("spaceHeaterLow").value;


  //         //     panel.waterHeater.use = {
  //         //       LE:  {state: "on", value: lowerAirTemp},
  //         //       GE:  {state: "off", value: upperAirTemp}
  //         //     };
  //         // }

  //         // checkOnOff = document.getElementById("checkAirPump").checked;
  //         // if (checkOnOff) {
  //         //   var upperOxy = document.getElementById("airPumpHigh").value;
  //         //   var lowerOxy = document.getElementById("airPumpLow").value;
  //         //   panel.panel.airPump.use = {
  //         //     on:  {LE: upperOxy},
  //         //     off: {GE: lowerOxy}
  //         //   };
  //         // }


  //         // checkOnOff = document.getElementById("checkWaterPump").checked;
  //         // if (checkOnOff) {
  //         //     var onTimeX=document.getElementById("waterPumpHigh").selectedIndex;
  //         //     var onTimeY=document.getElementById("waterPumpHigh").options;
  //         //     var onTime = onTimeY[onTimeX].value;

  //         //     var offTimeX=document.getElementById("waterPumpLow").selectedIndex;
  //         //     var offTimeY=document.getElementById("waterPumpLow").options;
  //         //     var offTime = offTimeY[offTimeX].value;

  //         //   panel.panel.waterPump.use = {
  //         //     on:  onTime,
  //         //     off: offTime
  //         //   };
  //         // }


  //         var x=document.getElementById("schedule").selectedIndex;
  //         var y=document.getElementById("schedule").options;
  //         // alert("Schedule updated: " + y[x].text );
  //         var timerValue = y[x].value;

  //         if (data.value == false) {
  //           socket.emit('command', {module: 'stopSchedule'})

  //         }
  //         socket.emit('command', {'panel': panel, module: 'arkSchedule', interval: '' + timerValue*1000, state: data.value})
  //         // socket.emit('command', {module: 'sensorSchedule', interval: '' + timerValue*1000})


  //       });

   </script>


<script>
gAtEnd = true;
gLength = 0;
var chart = null;
var chartData = [];
var chartCursor;

// create chart
AmCharts.ready(function() {
    chart = new AmCharts.AmSerialChart();
    chart.pathToImages = "http://www.amcharts.com/lib/images/";
    chart.marginTop = 0;
    chart.marginRight = 10;
    chart.autoMarginOffset = 5;
    chart.zoomOutButton = {
        backgroundColor: '#000000',
        backgroundAlpha: 0.15
    };
    chart.dataProvider = chartData;
    chart.categoryField = "date";

    // AXES
    // category
    var categoryAxis = chart.categoryAxis;
    categoryAxis.parseDates = true; // as our data is date-based, we set parseDates to true
    categoryAxis.minPeriod = "ss";
    categoryAxis.dashLength = 1;
    categoryAxis.gridAlpha = 0.15;
    categoryAxis.axisColor = "#DADADA";

    // value
    var valueAxis = new AmCharts.ValueAxis();
    valueAxis.axisAlpha = 0.2;
    valueAxis.dashLength = 1;
    chart.addValueAxis(valueAxis);

    // GRAPH
    var graph = new AmCharts.AmGraph();
    graph.title = "red line";
    graph.valueField = "readings";
    graph.bullet = "round";
    graph.bulletBorderColor = "#FFFFFF";
    graph.bulletBorderThickness = 2;
    graph.lineThickness = 2;
    graph.lineColor = "#b5030d";
    //graph.negativeLineColor = "#0352b5";
    graph.hideBulletsCount = 50; // this makes the chart to hide bullets when there are more than 50 series in selection
    chart.addGraph(graph);

    // CURSOR
    chartCursor = new AmCharts.ChartCursor();
    chartCursor.cursorPosition = "mouse";
    chart.addChartCursor(chartCursor);

    // SCROLLBAR
    var chartScrollbar = new AmCharts.ChartScrollbar();
    chartScrollbar.graph = graph;
    chartScrollbar.scrollbarHeight = 40;
    chartScrollbar.color = "#FFFFFF";
    chartScrollbar.autoGridCount = true;
    chart.addChartScrollbar(chartScrollbar);

    chart.zoomOutOnDataUpdate = false;
    chart.addListener("zoomed", handleZoom);

    // WRITE
    chart.write("sensaChart");
});


function handleZoom(event) {
    if(event.endIndex+1 == event.chart.chartData.length) {
        //console.log('at end');
        gAtEnd = true;
        gLength = event.endIndex - event.startIndex;
    }
    else gAtEnd = false;
}

</script>
<script>
//     function updateClock ( )
//     {
//       var currentTime = new Date ( );

//       var currentHours = currentTime.getHours ( );
//       var currentMinutes = currentTime.getMinutes ( );
//       var currentSeconds = currentTime.getSeconds ( );

//       // Pad the minutes and seconds with leading zeros, if required
//       currentMinutes = ( currentMinutes < 10 ? "0" : "" ) + currentMinutes;
//       currentSeconds = ( currentSeconds < 10 ? "0" : "" ) + currentSeconds;

//       // Choose either "AM" or "PM" as appropriate
//       var timeOfDay = ( currentHours < 12 ) ? "AM" : "PM";

//       // Convert the hours component to 12-hour format if needed
//       currentHours = ( currentHours > 12 ) ? currentHours - 12 : currentHours;

//       // Convert an hours component of "0" to "12"
//       currentHours = ( currentHours == 0 ) ? 12 : currentHours;

//       // Compose the string for display
//       var currentTimeString = currentHours + ":" + currentMinutes + ":" + currentSeconds + " " + timeOfDay;

//       // Update the time display
//       document.getElementById("clock").firstChild.nodeValue = currentTimeString;
//       // document.getElementById("date").firstChild.nodeValue = currentDateString;

//     }

// var date = new Date();
//
// function getTime() {
//
//   var hour = date.getHours();
//   hour = (hour < 10 ? "0" : "") + hour;
//
//   var min  = date.getMinutes();
//   min = (min < 10 ? "0" : "") + min;
//
//   var sec  = date.getSeconds();
//   sec = (sec < 10 ? "0" : "") + sec;
//
//   return hour + ":" + min + ":" + sec;
// }
//
//
// function getDate() {
//   var year = date.getFullYear();
//
//   var month = date.getMonth() + 1;
//   month = (month < 10 ? "0" : "") + month;
//
//   var day  = date.getDate();
//   day = (day < 10 ? "0" : "") + day;
//
//   return month + "-" + day + "-" + year;
//
// }

//     function sensorNow ()
//     {
//       socket.emit('command', {data:'on', module:'allSensors'});

//     }

//
</script>
</body>
</html>
